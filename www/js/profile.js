// Generated by CoffeeScript 1.10.0

/*
* Cepat Sembuh v1.0
* Copyright 2016 Cepat Sembuh
 */

(function() {
  var getNoAntri;

  getNoAntri = function(tipe, username, name) {
    var faskesRef, nama, nik, pasien;
    faskesRef = new Firebase('https://cepatsembuh.firebaseio.com/' + tipe + '/faskes/' + username);
    console.log('Url :' + 'https://cepatsembuh.firebaseio.com/' + tipe + '/faskes/' + username);
    alert('Fitur ini membutuhkan internet untuk mengambil data');
    alert('Mohon konfirmasi ulang');
    nama = prompt('Masukan nama');
    nik = prompt('Masukan NIK:');
    if (nama !== '' || nik.length !== 16) {
      pasien = new Firebase('https://cepatsembuh.firebaseio.com/' + tipe + '/pasien/');
      faskesRef.on('value', function(snapshot) {
        var data, one, sum;
        data = snapshot.val().antrian;
        one = 1;
        sum = data + one;
        faskesRef.update({
          nama: name,
          antrian: sum
        });
        alert('No antrian: ' + snapshot.val().antrian);
        pasien.push().set({
          nama: nama,
          nomor_antrian: snapshot.val().antrian
        });
      });
    } else {
      alert('Input anda tidak valid. \n Anda tidak bisa mendapatkan nomor antrian');
    }
  };

  document.addEventListener('deviceready', function() {
    Firebase.goOnline();
  });

  $('#not-available').on('click', function() {
    alert('Faskes is not available');
  });

}).call(this);
